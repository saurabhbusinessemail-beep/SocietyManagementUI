<app-layout [hideMoreActions]="!isFlatMember">

    <ng-container moreActions>
        <ui-button label="New Complaint" type="primary" (clicked)="openAddComplaint()" [smColumns]="1" [mdColumns]="1"
            [lgColumns]="1">
        </ui-button>
    </ng-container>


    <div class="flex-col full-h">
        <app-filter [dropDownControlConfigs]="[complaintTypeConfig]" (isFlatMemberChanged)="isFlatMember=$event"
            [smColumns]="12" [mdColumns]="12" [lgColumns]="12" (filterChanged)="loadComplaints($event)">

            <ui-select2 [formControl]="complaintTypeControl" [config]="complaintTypeConfig"
                [options]="complaintTypeConfig.dropDownOptions ?? []" [smColumns]="12" [mdColumns]="2" [lgColumns]="2">
            </ui-select2>
        </app-filter>

        <ui-form-layout class="flex-auto">

            <ng-container *ngFor=" let complaint of complaints">

                <ui-complaint-card [complaint]="complaint" [smColumns]="12" [mdColumns]="6" [lgColumns]="6"
                    [canApprove]="isStatusTransitionAllowed(complaint, 'approved') && amIManagerOfSociety(complaint)"
                    [canReject]="isStatusTransitionAllowed(complaint, 'rejected') && amIManagerOfSociety(complaint)"
                    [canMoveToProgress]="isStatusTransitionAllowed(complaint, 'in_progress') && amIManagerOfSociety(complaint)"
                    [canMarkResolved]="isStatusTransitionAllowed(complaint, 'resolved') && amIManagerOfSociety(complaint)"
                    [canClose]="isStatusTransitionAllowed(complaint, 'closed') && isMyComplaint(complaint)"
                    (statusChange)="changeStatus(complaint, $event)">
                </ui-complaint-card>

            </ng-container>

        </ui-form-layout>
    </div>

</app-layout>